<div class="barra-filtros p-1 surface-50 border-round shadow-1 flex align-items-center gap-3">
  <button pButton [label]="escuelaSeleccionada?.nombre || 'Seleccionar Escuela'"
          icon="pi pi-chevron-down"
          class="p-button-sm"
          (click)="dialogoCarreraVisible = true">
  </button>

  <span class="divisor"></span>
  <span class="etiqueta-rol">{{ rolActual.nombre }}</span>

  <div class="botones-navegacion flex align-items-center gap-2">
    <button pButton icon="pi pi-angle-left" class="p-button-text p-button-sm" (click)="rolAnterior()"></button>
    <button pButton icon="pi pi-angle-right" class="p-button-text p-button-sm" (click)="rolSiguiente()"></button>
  </div>

  <div class="flex align-items-center gap-2 ml-auto">
    <label for="busqueda">Buscar</label>
    <input pInputText id="busqueda" [(ngModel)]="busqueda" class="p-inputtext-sm" />
  </div>
</div>

<div class="grid">
  <!-- Panel izquierdo: Formulario -->
  <div class="col-12 md:col-5 lg:col-4">
    <p-card header="Registro de Usuarios">
      <div class="p-fluid formgrid grid">
        <div class="field col-12">
          <label>Apellidos</label>
          <input pInputText [(ngModel)]="persona.apellido" />
        </div>

        <div class="field col-12">
          <label>Nombres</label>
          <input pInputText [(ngModel)]="persona.nombre" />
        </div>

        <div class="field col-6">
          <label>DNI</label>
          <input pInputText [(ngModel)]="persona.dni" />
        </div>

        <div class="field col-6">
          <label>Teléfono</label>
          <input pInputText [(ngModel)]="persona.telefono" />
        </div>

        <div class="field col-12">
          <label>Correo Electrónico</label>
          <input pInputText [(ngModel)]="persona.correoElectronico" />
        </div>

        <div class="field col-12">
          <label>Dirección</label>
          <input pInputText [(ngModel)]="persona.direccion" />
        </div>

        <div class="field col-6">
          <label>Semestre</label>
          <p-dropdown [options]="['2023-I', '2023-II', '2024-I']" [(ngModel)]="semestreSeleccionado"></p-dropdown>
        </div>

        <div class="field col-6">
          <label>Línea</label>
          <p-dropdown [options]="lineas" [(ngModel)]="lineaSeleccionada" optionLabel="nombre"></p-dropdown>
        </div>
      </div>

      <div class="flex justify-content-end mt-3">
        <button pButton label="Agregar" icon="pi pi-plus" (click)="agregarTemporal()"></button>
      </div>
    </p-card>

    <!-- Lista temporal -->
    <p-card header="Usuarios Temporales" class="mt-3">
      <div class="temporal-list">
        <div *ngFor="let usuario of usuariosTemporales; let i = index"
             class="temporal-item p-2 border-round mb-2 surface-100">
          <div class="flex align-items-center justify-content-between">
            <span>{{usuario.nombre}} {{usuario.apellido}}</span>
            <button pButton icon="pi pi-trash"
                    class="p-button-danger p-button-text p-button-sm"
                    (click)="eliminarTemporal(i)">
            </button>
          </div>
        </div>
      </div>
      <div *ngIf="usuariosTemporales.length > 0" class="flex justify-content-end mt-3">
        <button pButton label="Confirmar Todos"
                icon="pi pi-check"
                (click)="confirmarUsuarios()">
        </button>
      </div>
    </p-card>
  </div>

  <!-- Panel derecho: Tabla de usuarios registrados -->
  <div class="col-12 md:col-7 lg:col-8">
    <p-card header="Usuarios Registrados">
      <p-table [value]="usuariosRegistrados"
               [paginator]="true"
               [rows]="10"
               [responsive]="true"
               styleClass="p-datatable-sm">
        <ng-template pTemplate="header">
          <tr>
            <th>Nombre</th>
            <th>Apellido</th>
            <th>Rol</th>
            <th>Escuela</th>
            <th>Semestre</th>
            <th>Acciones</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-usuario>
          <tr>
            <td>{{usuario.nombre}}</td>
            <td>{{usuario.apellido}}</td>
            <td>{{usuario.rol}}</td>
            <td>{{usuario.escuela}}</td>
            <td>{{usuario.semestre}}</td>
            <td>
              <button pButton icon="pi pi-pencil"
                      class="p-button-text p-button-sm mr-2">
              </button>
              <button pButton icon="pi pi-trash"
                      class="p-button-danger p-button-text p-button-sm">
              </button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-card>
  </div>
</div>

<p-toast></p-toast>
